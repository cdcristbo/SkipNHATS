select(-c(textResID,pattern)) %>%
ungroup() %>%
group_by(Questionnaire.ITEM) %>%
distinct() %>%
mutate(fldResponsesID = paste(fldResponseID, collapse = ",")) %>%
ungroup() %>%
select(-fldResponseID) %>%
distinct() %>%
select("fldSectionID","Questionnaire.ITEM","Variable.name","fldResponsesID","OtherSkip2","indicatorByResIDValue","skipPrior","text") %>%
mutate(skipbyuniplicable = case_when(is.na(OtherSkip2) ~ NA,
OtherSkip2 == " " ~ 0,
!is.na(OtherSkip2) ~ 1),
skipbyResIDValue = case_when(indicatorByResIDValue=="-1"~1,
is.na(indicatorByResIDValue)~NA,
indicatorByResIDValue!="-1"~0),
skipbyResIDPattern = case_when( is.na(skipbyuniplicable) & is.na(skipPrior) ~ NA,
skipbyuniplicable==0 & !is.na(skipPrior)~0,
skipbyuniplicable==0 & is.na(skipPrior)~0,
skipbyuniplicable==1 & !is.na(skipPrior) ~0,
skipbyuniplicable==1 & is.na(skipPrior)~1)) %>%
select(-c("OtherSkip2","indicatorByResIDValue","skipPrior")) %>%
select("fldSectionID","Questionnaire.ITEM","Variable.name","fldResponsesID",
"skipbyuniplicable","skipbyResIDValue","skipbyResIDPattern","text") %>%
rename(indicatorByResID = "skipbyuniplicable",
skipbyResID = "skipbyResIDValue",
skipbyResIDPattern = "skipbyResIDPattern")
patternData
patternDataB <- patternData %>%
filter(grepl("BOX", Questionnaire.ITEM)) #%>%
patternDataB
patternDataB$if_col <- str_extract(patternDataB$`tblQuestionText-QuestionText - EN`, "(?<=If ).*?(?= =)")
patternDataB$go_col <- str_extract(patternDataB$`tblQuestionText-QuestionText - EN`, "(?<=go to ).*?(?=\\.)")
patternDataB$final_col <- str_extract(patternDataB$`tblQuestionText-QuestionText - EN`, "(?<=Otherwise, go to ).*?(?=\\.)")
box
table(data2[[patternData$name_if]], data2[[patternData$name_go]])
box
boxTable = box %>%
filter(Var1 == 2 & Freq > 0)
boxTable
# Load required libraries
library(readr)
library(dplyr)
library(openxlsx)
library(readxl)
library(openxlsx)
library(tidyverse)
library(xlsx)
#write.xlsx(FinalPresentHC, file = paste0(base_path, "outcomes/BaseWoCleanv04.xlsx"))
library(xlsx)
library(openxlsx)
FinalPresentHC <- read.xlsx(paste0(base_path, "outcomes/BaseWoCleanv03.xlsx"))
ItemPF = FinalPresentHC %>%
filter(skipbyResID==1) %>%
summarise(n()) %>%
as.numeric()
Itembyr1dresid = FinalPresentHC %>%
filter(skipbyResID ==1 & AdditionalSkipByResID ==0)%>%
summarise(n()) %>%
as.numeric()
Itembyr1dresidandPrior = FinalPresentHC %>%
filter(AdditionalSkipByResID ==1 & skipbyResIDPattern ==0)%>%
summarise(n()) %>%
as.numeric()
ItemRemain = FinalPresentHC %>%
filter(AdditionalSkipByResID ==1 & skipbyResIDPattern ==1 &
skipbyResIDPattern ==1) %>%
summarise(n()) %>%
as.numeric()
cat("Total number of variables available in public file in HC section:", ItemPF,"\n",
"skipped only by r1dresid:", Itembyr1dresid,"\n",
"skipped by r1dresid and prior variables:", Itembyr1dresidandPrior,"\n",
"Remaining box:", ItemRemain, "\n",
"remaining others",)
cat("Total number of variables available in public file in HC section:", ItemPF,"\n",
"skipped only by r1dresid:", Itembyr1dresid,"\n",
"skipped by r1dresid and prior variables:", Itembyr1dresidandPrior,"\n",
"Remaining box:", ItemRemain, "\n",
"remaining others","0")
library(openxlsx)
# Load the existing workbook
wb <- loadWorkbook(paste0(base_path, "outcomes/BaseWoCleanv04.xlsx"))
# Load the existing workbook
wb <- loadWorkbook(paste0(base_path, "outcomes/BaseWoCleanv03.xlsx"))
# Create a new sheet
createSheet(wb, name = "NewSheet")
# Load the existing workbook
wb <- loadWorkbook(paste0(base_path, "outcomes/BaseWoCleanv03.xlsx"))
# Load the existing workbook
wb <- loadWorkbook(paste0(base_path, "outcomes/BaseWoCleanv03.xlsx"))
# Add a new worksheet
addWorksheet(wb, "SummaryHC")
# Add a new worksheet
addWorksheet(wb, "SummaryHC2")
# Write data to the new sheet
writeData(wb, sheet = "NewSheet",
x = c(paste("Total number of variables available in public file in HC section:", ItemPF),
paste("skipped only by r1dresid:", Itembyr1dresid),
paste("skipped by r1dresid and prior variables:", Itembyr1dresidandPrior),
paste("Remaining box:", ItemRemain),
"Remaining others: 0"))
# Write data to the new sheet
writeData(wb, sheet = "SummaryHC2",
x = c(paste("Total number of variables available in public file in HC section:", ItemPF),
paste("skipped only by r1dresid:", Itembyr1dresid),
paste("skipped by r1dresid and prior variables:", Itembyr1dresidandPrior),
paste("Remaining box:", ItemRemain),
"Remaining others: 0"))
# Save the workbook
saveWorkbook(wb, paste0(base_path, "outcomes/BaseWoCleanv04.xlsx"), overwrite = TRUE)
# Load required libraries
library(readr)
library(dplyr)
library(openxlsx)
library(readxl)
library(openxlsx)
library(tidyverse)
library(xlsx)
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
# Load saved data
load(paste0(base_path, "outcomes/Rdresid.RData")) # result_df
load(paste0(base_path, "outcomes/SkipPattern.RData")) # results_df
load(paste0(base_path, "outcomes/results_box.RData"))
# Load custom function
processData <- paste0(base_path, "Functions/processData.R")
source(processData)
# Process data using custom function
patternData <- processData(Part2, fullList, trueNames) %>%
select(-countpat) %>%
distinct()
# Filter out rows with missing values in pattern and Variable.name columns
patternData2 <- patternData %>%
filter(!is.na(pattern) & !is.na(Variable.name))
# Remove unnecessary columns from result_df
datsRdresid <- result_df %>%
mutate(firstskipPattern = paste0("hc1", label)) %>%
select(-label)
# Filter out rows with missing values in pattern and Variable.name columns
patternData2 <- patternData %>%
filter(!is.na(pattern) & !is.na(Variable.name))
# Remove unnecessary columns from result_df
datsRdresid <- result_df %>%
mutate(firstskipPattern = paste0("hc1", label)) %>%
select(-label)
data
patternData
targetColumn
View(patternData)
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
9=4
9-1
patternData
i
targetColumn
i=101
# Extract the targetColumn, skipVariable, and pattern from the current row
targetColumn <- patternData[i, "Variable.name"]
targetColumn
skipVariable <- patternData[i, "name1"]
pattern <- patternData[i, "pattern"]
pattern
!is.na(pattern) && !grepl(",", pattern)
result <- getRowsGroup2(data, patternData[i, ], patternData[i, ]$Variable.name, patternData[i, ]$name2)
getRowsGroup2 <- paste0(base_path, "Functions/getRowsGroup2.R")
processData <- paste0(base_path, "Functions/processData.R")
#A=load(paste0(base_path, "outcomes/FinalPresent.RData"))
getRowsGroup1 <- paste0(base_path, "Functions/getRowsGroup1.R")
# Load the R script containing getRowsGroup1 and getRowsGroup2 function2
source(getRowsGroup1)
source(getRowsGroup2)
source(processData)
# Set the folder path
folder_path <- paste0(base_path, "datasets/SP")
# Get a list of all .dta files in the folder
file_list <- list.files(path = folder_path, pattern = ".dta", full.names = TRUE)
file_list = file_list[1]
# Create an empty dataframe to store the results
result_df <- data.frame(variable = character(0), round1Inaplicable = character(0))
data <- read_dta(file_list)
#FinalPresent<- processData(Part2, fullList, trueNames)
#patternData = FinalPresent
patternData = processData(Part2, fullList, trueNames)
patternData = patternData %>%
mutate(pattern = ifelse(Variable.name==name1,NA,pattern)) %>%
filter(!is.na(pattern) & !is.na(Variable.name))
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
trueNames <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.xlsx"))
#A=load(paste0(base_path, "outcomes/FinalPresent.RData"))
getRowsGroup1 <- paste0(base_path, "Functions/getRowsGroup1.R")
getRowsGroup2 <- paste0(base_path, "Functions/getRowsGroup2.R")
processData <- paste0(base_path, "Functions/processData.R")
# Load the R script containing getRowsGroup1 and getRowsGroup2 function2
source(getRowsGroup1)
source(getRowsGroup2)
source(processData)
# Set the folder path
folder_path <- paste0(base_path, "datasets/SP")
# Get a list of all .dta files in the folder
file_list <- list.files(path = folder_path, pattern = ".dta", full.names = TRUE)
file_list = file_list[1]
# Create an empty dataframe to store the results
result_df <- data.frame(variable = character(0), round1Inaplicable = character(0))
data <- read_dta(file_list)
#FinalPresent<- processData(Part2, fullList, trueNames)
#patternData = FinalPresent
patternData = processData(Part2, fullList, trueNames)
patternData = patternData %>%
mutate(pattern = ifelse(Variable.name==name1,NA,pattern)) %>%
filter(!is.na(pattern) & !is.na(Variable.name))
# Create the 'FinalPresent' data frame
FinalPresent <- final %>%
select(-c(id, countpat)) %>%
distinct() %>%
left_join(items %>%
select(-c(`Variable name`,`Variable label`)) %>%
rename(Questionnaire.ITEM = fldItemID)) %>%
select(-fldResponseID, ) %>%
distinct(Questionnaire.ITEM,Variable.name,fldSkipTo,nameSkip,item1,item2,
name2,pattern,fldSectionID,`tblItem-Numb`,name1 )
# Load the R script containing getRowsGroup1 and getRowsGroup2 function2
source(getRowsGroup1)
source(getRowsGroup2)
source(processData)
processData <- paste0(base_path, "Functions/processData.R")
# Load the R script containing getRowsGroup1 and getRowsGroup2 function2
source(getRowsGroup1)
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
View(patternData)
results_df = NULL
i=53
# Extract the targetColumn, skipVariable, and pattern from the current row
targetColumn <- patternData[i, "Variable.name"]
skipVariable <- patternData[i, "name1"]
pattern <- patternData[i, "pattern"]
# Extract the targetColumn, skipVariable, and pattern from the current row
targetColumn <- patternData[i, "Variable.name"]
#FinalPresent<- processData(Part2, fullList, trueNames)
#patternData = FinalPresent
patternData = processData(Part2, fullList, trueNames)
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
read.csv(paste0(base_path, "datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.xlsx"))
trueNames = read.csv(paste0(base_path, "datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.xlsx"))
View(trueNames)
library(readr)
NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0 <- read_csv("C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.csv")
View(NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0)
trueNames = read_csv("C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.csv")
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
trueNames = read_csv("C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.csv")
#A=load(paste0(base_path, "outcomes/FinalPresent.RData"))
getRowsGroup1 <- paste0(base_path, "Functions/getRowsGroup1.R")
getRowsGroup2 <- paste0(base_path, "Functions/getRowsGroup2.R")
processData <- paste0(base_path, "Functions/processData.R")
# Load the R script containing getRowsGroup1 and getRowsGroup2 function2
source(getRowsGroup1)
source(getRowsGroup2)
source(processData)
# Set the folder path
folder_path <- paste0(base_path, "datasets/SP")
# Get a list of all .dta files in the folder
file_list <- list.files(path = folder_path, pattern = ".dta", full.names = TRUE)
file_list = file_list[1]
# Create an empty dataframe to store the results
result_df <- data.frame(variable = character(0), round1Inaplicable = character(0))
data <- read_dta(file_list)
#FinalPresent<- processData(Part2, fullList, trueNames)
#patternData = FinalPresent
patternData = processData(Part2, fullList, trueNames)
patternData = patternData %>%
mutate(pattern = ifelse(Variable.name==name1,NA,pattern)) %>%
filter(!is.na(pattern) & !is.na(Variable.name))
results_df = NULL
View(patternData)
i=13
# Extract the targetColumn, skipVariable, and pattern from the current row
targetColumn <- patternData[i, "Variable.name"]
skipVariable <- patternData[i, "name1"]
pattern <- patternData[i, "pattern"]
pattern
!is.na(pattern) && grepl(",", pattern)
result <- getRowsGroup2(data, patternData[i, ], patternData[i, ]$Variable.name, patternData[i, ]$name2)
result
targetColumn = patternData[i, ]
targetColumn
patternData = patternData[i, ]
patternData
targetColumn = patternData[i, ]$Variable.name
targetColumn
patternData[i, ]$Variable.name
patternData[i, ]
#FinalPresent<- processData(Part2, fullList, trueNames)
#patternData = FinalPresent
patternData = processData(Part2, fullList, trueNames)
patternData = patternData %>%
mutate(pattern = ifelse(Variable.name==name1,NA,pattern)) %>%
filter(!is.na(pattern) & !is.na(Variable.name))
results_df = NULL
# Extract the targetColumn, skipVariable, and pattern from the current row
targetColumn <- patternData[i, "Variable.name"]
skipVariable <- patternData[i, "name1"]
pattern <- patternData[i, "pattern"]
targetColumn
targetColumn
View(patternData)
# Extract relevant information from the patternData
info <- patternData %>%
filter(Variable.name == targetColumn & name2 == skipVariable) %>%
mutate(numberskip1 = as.numeric(str_extract(item1, "(?<=\\=)\\d+"))) %>%
mutate(numberskip2 = as.numeric(str_extract(item2, "(?<=\\=)\\d+"))) %>%
distinct(Variable.name, Questionnaire.ITEM, item1, name1, item2, name2, pattern, numberskip1, numberskip2)
info
skipVariable
targetColumn
skipVariable
targetColumn
patternData
# Extract relevant information from the patternData
info <- patternData %>%
filter(Variable.name == targetColumn & name2 == skipVariable) %>%
mutate(numberskip1 = as.numeric(str_extract(item1, "(?<=\\=)\\d+"))) %>%
mutate(numberskip2 = as.numeric(str_extract(item2, "(?<=\\=)\\d+"))) %>%
distinct(Variable.name, Questionnaire.ITEM, item1, name1, item2, name2, pattern, numberskip1, numberskip2)
info
#FinalPresent<- processData(Part2, fullList, trueNames)
#patternData = FinalPresent
patternData = processData(Part2, fullList, trueNames)
patternData = patternData %>%
mutate(pattern = ifelse(Variable.name==name1,NA,pattern)) %>%
filter(!is.na(pattern) & !is.na(Variable.name))
results_df = NULL
# Extract the targetColumn, skipVariable, and pattern from the current row
targetColumn <- patternData[i, "Variable.name"]
skipVariable <- patternData[i, "name1"]
pattern <- patternData[i, "pattern"]
pattern
skipVariable
targetColumn
patternData
patternData <- patternData[i, "pattern"]
patternData
targetColumn
skipVariable
# Extract relevant information from the patternData
info <- patternData %>%
filter(Variable.name == targetColumn & name2 == skipVariable) %>%
mutate(numberskip1 = as.numeric(str_extract(item1, "(?<=\\=)\\d+"))) %>%
mutate(numberskip2 = as.numeric(str_extract(item2, "(?<=\\=)\\d+"))) %>%
distinct(Variable.name, Questionnaire.ITEM, item1, name1, item2, name2, pattern, numberskip1, numberskip2)
patternData
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
# Load necessary libraries
library(dplyr)
library(haven)
library(readxl)
library(stringr)
# Set common base path
base_path <- "C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/"
# Read the necessary Excel files
Part2 <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "ItemResponse")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
#trueNames <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.xlsx"))
trueNames = read_csv("C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.csv")
library(readr)
#trueNames <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.xlsx"))
trueNames = read_csv("C:/Users/ccris/Dropbox (University of Michigan)/carlos/Work/Nhats/SkipNHATS/datasets/SkipDataset/NHATS_R1_Crosswalk_between_Instruments_and_Codebook_0.csv")
fullList <- read_excel(paste0(base_path, "datasets/SkipDataset/NHATSNationalStudyRound1SpecWriterExchange.xlsx"), sheet = "Item")
